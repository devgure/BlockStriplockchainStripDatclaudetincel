
_format_version: "3.0"

services:
  - name: auth-service
    url: http://auth-service:3001
    routes:
      - name: auth-route
        paths:
          - /api/v1/auth
        strip_path: false
    plugins:
      - name: rate-limiting
        config:
          minute: 100
          policy: local

  - name: profile-service
    url: http://profile-service:3002
    routes:
      - name: profile-route
        paths:
          - /api/v1/profiles
        strip_path: false
    plugins:
      - name: jwt
        config:
          secret_is_base64: false
      - name: rate-limiting
        config:
          minute: 200

  - name: match-service
    url: http://match-service:3003
    routes:
      - name: match-route
        paths:
          - /api/v1/matches
        strip_path: false
    plugins:
      - name: jwt
      - name: rate-limiting
        config:
          minute: 500

  - name: chat-service
    url: http://chat-service:3004
    routes:
      - name: chat-route
        paths:
          - /api/v1/chat
        strip_path: false
    plugins:
      - name: jwt
      - name: rate-limiting
        config:
          minute: 1000

  - name: payment-service
    url: http://payment-service:3005
    routes:
      - name: payment-route
        paths:
          - /api/v1/payments
        strip_path: false
    plugins:
      - name: jwt
      - name: rate-limiting
        config:
          minute: 50

  - name: location-service
    url: http://location-service:9000
    routes:
      - name: location-route
        paths:
          - /api/v1/location
        strip_path: false
    plugins:
      - name: jwt

  - name: ai-service
    url: http://ai-service:8000
    routes:
      - name: ai-route
        paths:
          - /api/v1/ai
        strip_path: false
    plugins:
      - name: jwt
      - name: rate-limiting
        config:
          minute: 100

plugins:
  - name: cors
    config:
      origins:
        - "*"
      methods:
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
      headers:
        - Authorization
        - Content-Type
      credentials: true